global:
  scrape_interval: 15s

scrape_configs:
  - job_name: 'ktrdr-backend'
    metrics_path: '/metrics/'
    static_configs:
      - targets: ['backend:8000']

  # Worker Node B - All possible worker ports
  - job_name: 'ktrdr-workers-b'
    static_configs:
      - targets:
        - 'workers-b.ktrdr.home.mynerd.place:5003'  # backtest-worker-1 (default)
        - 'workers-b.ktrdr.home.mynerd.place:5004'  # backtest-worker-2 (scale-2)
        - 'workers-b.ktrdr.home.mynerd.place:5005'  # training-worker-1 (default)
        - 'workers-b.ktrdr.home.mynerd.place:5006'  # training-worker-2 (scale-2)
        - 'workers-b.ktrdr.home.mynerd.place:5007'  # backtest-worker-3 (scale-3)
        - 'workers-b.ktrdr.home.mynerd.place:5008'  # training-worker-3 (scale-3)
    metrics_path: '/metrics/'

  # Worker Node C - All possible worker ports
  - job_name: 'ktrdr-workers-c'
    static_configs:
      - targets:
        - 'workers-c.ktrdr.home.mynerd.place:5003'  # backtest-worker-1 (default)
        - 'workers-c.ktrdr.home.mynerd.place:5004'  # backtest-worker-2 (scale-2)
        - 'workers-c.ktrdr.home.mynerd.place:5005'  # training-worker-1 (default)
        - 'workers-c.ktrdr.home.mynerd.place:5006'  # training-worker-2 (scale-2)
        - 'workers-c.ktrdr.home.mynerd.place:5007'  # backtest-worker-3 (scale-3)
        - 'workers-c.ktrdr.home.mynerd.place:5008'  # training-worker-3 (scale-3)
    metrics_path: '/metrics/'

  # GPU Worker - Training only (with GPU capability)
  - job_name: 'ktrdr-gpu-worker'
    static_configs:
      - targets:
        - 'ktrdr-gpuworker.ktrdr.home.mynerd.place:5005'  # GPU training worker
    metrics_path: '/metrics/'

# Note: Prometheus will mark targets as DOWN if workers are not running.
# This is expected when using profiles to scale workers up/down.
# Only active workers will show metrics; inactive ports will show as DOWN in Prometheus UI.
